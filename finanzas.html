<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AREY - Control de Ingresos y Egresos</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #556b2f;
      color: white;
      padding: 2rem 1rem;
      text-align: center;
    }
    header h1 {
      font-size: 3rem;
      margin: 0;
    }
    header h2 {
      font-size: 1rem;
      margin-top: 0.5rem;
    }
    main {
      max-width: 700px;
      margin: 2rem auto;
      padding: 1rem;
    }
    .card {
      background: white;
      border-radius: 1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      padding: 1.5rem;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    label {
      font-weight: bold;
    }
    select, input[type="number"], textarea {
      padding: 0.5rem;
      border-radius: 0.5rem;
      border: 1px solid #ccc;
      width: 100%;
    }
    textarea {
      resize: vertical;
    }
    button {
      background-color: #d63384;
      color: white;
      padding: 0.75rem;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover {
      opacity: 0.9;
    }
    .success-message {
      display: none;
      color: green;
      text-align: center;
      margin-bottom: 1rem;
    }
    @media (max-width: 600px) {
      header h1 { font-size: 2rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>AREY</h1>
    <h2>Control de Ingresos y Egresos</h2>
  </header>
  <main>
    <div class="card">
      <div class="success-message" id="successMessage">‚úÖ Datos enviados correctamente üéâ</div>
      <form id="controlForm">
        <input type="hidden" name="Fecha y hora del envi√≥" id="fechaHora" />
        <label>Unidad de negocio
          <select name="Unidad de negocio" required>
            <option value="">Selecciona‚Ä¶</option>
            <option>AREY Morelia</option>
            <option>AREY Capacitaci√≥n</option>
            <option>AREY For√°neo</option>
          </select>
        </label>
        <label>Registr√≥
          <select name="Registr√≥" required>
            <option value="">Selecciona‚Ä¶</option>
            <option>Yera</option>
            <option>Sara</option>
            <option>Marlene</option>
          </select>
        </label>
        <label>Tipo de movimiento
          <select name="Tipo de movimiento" id="tipoMovimiento" required>
            <option value="">Selecciona‚Ä¶</option>
            <option>Ingreso</option>
            <option>Egreso</option>
          </select>
        </label>

        <div id="ingresoFields" style="display:none;">
          <label>Ingreso
            <select name="Ingreso">
              <option value="">Selecciona‚Ä¶</option>
              <option>Delineado de ojos</option>
              <option>Depilaci√≥n con cera</option>
              <option>Extensiones de pesta√±as</option>
              <option>Masajes, Micropigmentaci√≥n de cejas</option>
              <option>Micropigmentaci√≥n de labios</option>
              <option>Micropigmentaci√≥n de ojos</option>
              <option>Plasma rico en plaquetas</option>
              <option>Power brows</option>
              <option>Tratamientos faciales</option>
              <option>Tratamientos reductivos</option>
              <option>Depilaci√≥n laser</option>
              <option>Curso labios y ojos</option>
              <option>Curso labios</option>
              <option>Curso ojos</option>
              <option>Curso de cejas, labios y ojos</option>
              <option>Curso micropigmentaci√≥n de cejas</option>
              <option>Curso de cera espa√±ola</option>
              <option>Curso Prp,Dermapen y BB Glow</option>
              <option>Curso Prp</option>
              <option>Curso Botox</option>
              <option>Curso micro pintura brasile√±a</option>
              <option>Curso Dermapen</option>
              <option>Curso BB Glow</option>
              <option>Curso Plasma Pen</option>
              <option>Curso mesoterapia</option>
              <option>Curso primeros auxilios</option>
              <option>Curso de asepsia y anti asepsia</option>
              <option>Diplomado de auxiliar de enfermer√≠a</option>
              <option>Diplomado de micropigmentaci√≥n facial</option>
              <option>Diplomado de podolog√≠a</option>
              <option>Diplomado dermocosmetologia</option>
              <option>Otros</option>
            </select>
          </label>
          <label style="display:none;">Especificar servicio o curso cobrado
            <textarea name="Especificar servicio o curso cobrado" id="especificarIngreso"></textarea>
          </label>
          <label>Forma de captaci√≥n
            <select name="Forma de captaci√≥n">
              <option value="">Selecciona‚Ä¶</option>
              <option>Cliente habitual</option>
              <option>Recomendaci√≥n</option>
              <option>Publicaci√≥n pagada</option>
              <option>Publicaci√≥n org√°nica</option>
              <option>Alumno</option>
            </select>
          </label>
          <label>Realiz√≥ el servicio
            <select name="Realiz√≥ el servicio">
              <option value="">Selecciona‚Ä¶</option>
              <option>Yera</option>
              <option>Sara</option>
            </select>
          </label>
          <label>Forma de pago
            <select name="Forma de pago">
              <option value="">Selecciona‚Ä¶</option>
              <option>Efectivo</option>
              <option>Tarjeta</option>
              <option>Transferencia</option>
            </select>
          </label>
        </div>

        <div id="egresoFields" style="display:none;">
          <label>Egreso
            <select name="Egreso">
              <option value="">Selecciona‚Ä¶</option>
              <option>Adquisici√≥n de mercanc√≠as</option>
              <option>Cafeter√≠a (Caf√©, T√©, az√∫car, agua, refresco)</option>
              <option>Extracci√≥n de utilidad</option>
              <option>Limpieza e higiene</option>
              <option>Mantenimiento</option>
              <option>Mobiliario y equipos</option>
              <option>Nomina</option>
              <option>Pago de comisiones</option>
              <option>Papeler√≠a</option>
              <option>Publicidad</option>
              <option>Renta</option>
              <option>Servicios (Agua, luz, internet)</option>
              <option>Viaticos (Gastos de trasporte, alimentos, hospedaje)</option>
              <option>Gastos personales</option>
              <option>Otros</option>
            </select>
          </label>
          <label style="display:none;">Especificar el tipo de egreso
            <textarea name="Especificar el tipo de egreso" id="especificarEgreso"></textarea>
          </label>
        </div>

        <label>Monto
          <input type="number" step="0.01" name="Monto" required />
        </label>
        <label>Observaciones
          <textarea name="Observaciones"></textarea>
        </label>

        <button type="submit">Enviar</button>
      </form>
    </div>
  </main>

  <script>
    const form = document.getElementById("controlForm");
    const tipoMovimiento = document.getElementById("tipoMovimiento");
    const ingresoFields = document.getElementById("ingresoFields");
    const egresoFields = document.getElementById("egresoFields");
    const successMessage = document.getElementById("successMessage");

    tipoMovimiento.addEventListener("change", () => {
      ingresoFields.style.display = tipoMovimiento.value === "Ingreso" ? "block" : "none";
      egresoFields.style.display = tipoMovimiento.value === "Egreso" ? "block" : "none";
    });

    document.querySelector("select[name='Ingreso']").addEventListener("change", (e) => {
      const especificar = document.getElementById("especificarIngreso").parentElement;
      especificar.style.display = e.target.value === "Otros" ? "block" : "none";
    });

    document.querySelector("select[name='Egreso']").addEventListener("change", (e) => {
      const especificar = document.getElementById("especificarEgreso").parentElement;
      especificar.style.display = e.target.value === "Otros" ? "block" : "none";
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      document.getElementById("fechaHora").value = new Date().toLocaleString("es-MX");
      const data = new FormData(form);
      try {
        await fetch("https://script.google.com/macros/s/AKfycbxdmnKxNCPKbxyTp_wnqbh6pBl-5g0_C19U8d0i6B-HROsAJ2hJV-5bBDPo_EhaSR6dyQ/exec", {
          method: "POST",
          body: data
        });
        successMessage.style.display = "block";
        form.reset();
        window.scrollTo({ top: 0, behavior: "smooth" });
        setTimeout(() => successMessage.style.display = "none", 5000);
      } catch (error) {
        alert("‚ùå Error al enviar los datos. Int√©ntalo nuevamente.");
      }
    });
  </script>
</body>
</html>
